apiVersion: apps/v1
kind: Deployment
metadata:
  name: {{ name }} # {"$ref":"#/definitions/io.k8s.cli.substitutions.appdeployment-name-value"}
  namespace: {{ namespace }} # {"$ref":"#/definitions/io.k8s.cli.setters.namespace"}
spec:
  selector:
    matchLabels:
      app: {{ name }} # {"$ref":"#/definitions/io.k8s.cli.setters.name"}
  replicas: 2 # {"$ref":"#/definitions/io.k8s.cli.setters.replicas"}
  template:
    metadata:
      labels:
        app: {{ name }} # {"$ref":"#/definitions/io.k8s.cli.setters.name"}
    spec:
      securityContext:
        runAsUser: 1000
        runAsNonRoot: true
      containers:
      - name: {{ name }}-container # {"$ref":"#/definitions/io.k8s.cli.substitutions.appcontainer-name-value"}
        image: {{ image }} # {"$ref":"#/definitions/io.k8s.cli.substitutions.image-value"}
        ports:
        - containerPort: {{ port }} # {"$ref":"#/definitions/io.k8s.cli.setters.port"}
          name: "container-port"
        {% if readinessProbePath %}
        readinessProbe:
          httpGet:
            path: {{ readinessProbePath }} # {"$ref":"#/definitions/io.k8s.cli.setters.readinessProbePath"}
            port: "container-port"
          initialDelaySeconds: 8
          periodSeconds: 10
          failureThreshold: 3
          successThreshold: 1
        {% endif %}
        {% if livenessProbePath %}
        livenessProbe:
          httpGet:
            path: {{ livenessProbePath }}" # {"$ref":"#/definitions/io.k8s.cli.setters.livenessProbePath"}
            port: "container-port"
          initialDelaySeconds: 8
          periodSeconds: 10
        {% endif %}
        resources:
          limits:
            cpu: 1
            memory: "1G"
